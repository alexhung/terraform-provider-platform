---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "platform_oidc_identity_mapping Resource - terraform-provider-platform"
subcategory: ""
description: |-
  Manage OIDC identity mapping for an OIDC configuration in JFrog platform. See the JFrog OIDC identity mappings documentation https://jfrog.com/help/r/jfrog-platform-administration-documentation/configure-identity-mappings for more information.
---

# platform_oidc_identity_mapping (Resource)

Manage OIDC identity mapping for an OIDC configuration in JFrog platform. See the JFrog [OIDC identity mappings documentation](https://jfrog.com/help/r/jfrog-platform-administration-documentation/configure-identity-mappings) for more information.

## Example Usage

```terraform
resource "platform_oidc_identity_mapping" "my-github-oidc-user-identity-mapping" {
  name          = "my-github-oidc-user-identity-mapping"
  description   = "My GitHub OIDC user identity mapping"
  provider_name = "my-github-oidc-configuration"
  priority      = 1

  claims_json = jsonencode({
    "sub" = "repo:humpty/access-oidc-poc:ref:refs/heads/main",
    "workflow_ref" = "humpty/access-oidc-poc/.github/workflows/job.yaml@refs/heads/main"
  })

  token_spec = {
    username   = "my-user"
    scope      = "applied-permissions/user"
    audience   = "*@*"
    expires_in = 7200
  }
}

resource "platform_oidc_identity_mapping" "my-github-oidc-group-identity-mapping" {
  name          = "my-github-oidc-group-identity-mapping"
  description   = "My GitHub OIDC group identity mapping"
  provider_name = "my-github-oidc-configuration"
  priority      = 1

  claims_json = jsonencode({
    "sub" = "repo:humpty/access-oidc-poc:ref:refs/heads/main",
    "workflow_ref" = "humpty/access-oidc-poc/.github/workflows/job.yaml@refs/heads/main"
  })

  token_spec = {
    scope      = "applied-permissions/groups:\"readers\",\"my-group\""
    audience   = "jfrt@* jfac@* jfmc@* jfmd@* jfevt@* jfxfer@* jflnk@* jfint@* jfwks@*"
    expires_in = 7200
  }
}

resource "platform_oidc_identity_mapping" "my-github-oidc-project-roles-identity-mapping" {
  name          = "my-github-oidc-project-role-identity-mapping"
  description   = "My GitHub OIDC Project role identity mapping"
  provider_name = "my-github-oidc-configuration"
  priority      = 1

  claims_json = jsonencode({
    "sub" = "repo:humpty/access-oidc-poc:ref:refs/heads/main",
    "workflow_ref" = "humpty/access-oidc-poc/.github/workflows/job.yaml@refs/heads/main"
  })

  token_spec = {
    scope      = "applied-permissions/roles:my-project:\"Project Admin\",\"Developer\""
    audience   = "jfrt@* jfac@* jfmc@* jfmd@* jfevt@* jfxfer@* jflnk@* jfint@* jfwks@*"
    expires_in = 7200
  }

  project_key = "my-project"
}

resource "platform_oidc_identity_mapping" "my-github-oidc-username-pattern-identity-mapping" {
  name          = "my-github-oidc-username-pattern-identity-mapping"
  description   = "My GitHub OIDC username pattern identity mapping"
  provider_name = "my-github-oidc-configuration"
  priority      = 1

  claims_json = jsonencode({
    "sub" = "repo:humpty/access-oidc-poc:ref:refs/heads/main",
    "workflow_ref" = "humpty/access-oidc-poc/.github/workflows/job.yaml@refs/heads/main"
  })

  token_spec = {
    username_pattern = "{{user}}"
    audience         = "*@*"
    expires_in       = 7200
  }
}

resource "platform_oidc_identity_mapping" "my-github-oidc-groups-pattern-identity-mapping" {
  name          = "my-github-oidc-groups-pattern-identity-mapping"
  description   = "My GitHub OIDC groups pattern identity mapping"
  provider_name = "my-github-oidc-configuration"
  priority      = 1

  claims_json = jsonencode({
    "sub" = "repo:humpty/access-oidc-poc:ref:refs/heads/main",
    "workflow_ref" = "humpty/access-oidc-poc/.github/workflows/job.yaml@refs/heads/main"
  })

  token_spec = {
    groups_pattern = "{{group}}"
    audience       = "*@*"
    expires_in     = 7200
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `claims_json` (String) Claims JSON from the OIDC provider. Use [Terraform jsonencode function](https://developer.hashicorp.com/terraform/language/functions/jsonencode) to encode the JSON string. Claims constitute the payload part of a JSON web token and represent a set of information exchanged between two parties. The JWT standard distinguishes between reserved claims, public claims, and private claims. In API Gateway context, both public claims and private claims are considered custom claims. For example, an ID token (which is always a JWT) can contain a claim called that asserts that the name of the user authenticating is "John Doe". In a JWT, a claim appears as a name/value pair where the name is always a string and the value can be any JSON value.
- `name` (String) Name of the OIDC identity mapping
- `priority` (Number) Priority of the identity mapping. The priority should be a number. The higher priority is set for the lower number. If you do not enter a value, the identity mapping is assigned the lowest priority. We recommend that you assign the highest priority (1) to the strongest permission gate. Set the lowest priority to the weakest permission for a logical and effective access control setup.
- `provider_name` (String) Name of the OIDC configuration
- `token_spec` (Attributes) Specifications of the token. In case of success, a token with the following details will be generated and passed to OIDC Provider. (see [below for nested schema](#nestedatt--token_spec))

### Optional

- `description` (String) Description of the OIDC mapping
- `project_key` (String) If set, this Identity Mapping will be available in the scope of the given project (editable by platform admin and project admin). If not set, this Identity Mapping will be global and only editable by platform admin. Once set, the projectKey cannot be changed.

<a id="nestedatt--token_spec"></a>
### Nested Schema for `token_spec`

Optional:

- `audience` (String) Sets of (space separated) the JFrog services to which the mapping applies. Default value is `*@*`, which applies to all services.
- `expires_in` (Number) Token expiry time in seconds. Default value is 60.
- `groups_pattern` (String) Provide a pattern which is used to map OIDC groups to Artifactory groups.
- `scope` (String) Scope of the token. Must start with `applied-permissions/user`, `applied-permissions/admin`, `applied-permissions/roles:`, or `applied-permissions/groups:`. Group names must be comma-separated, double quotes wrapped, e.g. `applied-permissions/groups:\"readers\",\"my-group\",` Role permissions are only applicable when in project scope and must be comma-separated, double quotes wrapped, e.g. `applied-permissions:roles:`project-key`:"Developer","Viewer". `username` is also required when setting role permission.
- `username` (String) User name of the OIDC user. Not applicable when `scope` is set to `applied-permissions/groups`. Must be set when `scope` is set to `applied-permissions/roles`.
- `username_pattern` (String) Provide a pattern which is used to map OIDC user to Artifactory user.

## Import

Import is supported using the following syntax:

```shell
terraform import platform_oidc_identity_mapping.my-oidc-identity-mapping my-oidc-identity-mapping:my-oidc-configuration

terraform import platform_oidc_identity_mapping.my-oidc-identity-mapping my-oidc-identity-mapping:my-oidc-configuration:myproj
```
